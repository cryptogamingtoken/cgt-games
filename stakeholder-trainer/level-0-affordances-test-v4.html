
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üå≥ Level 0 Affordances Test ‚Äì v4</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 1em;
      background-color: #f2f7f3;
      color: #222;
    }
    h1 {
      text-align: center;
    }
    .timer {
      text-align: center;
      font-size: 1.2em;
      margin-bottom: 1em;
    }
    .stakeholder {
      margin-bottom: 2em;
      padding: 0.5em;
      border-left: 4px solid green;
      background: white;
      box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
      width: fit-content;
    }
    .stakeholder.left {
      margin-left: 0;
    }
    .stakeholder.right {
      margin-left: auto;
    }
    .stakeholder h2 {
      margin: 0.5em 0;
      display: flex;
      align-items: center;
    }
    .leaf {
      background: #d8f7dd;
      padding: 0.4em 0.8em;
      margin: 0.3em 0;
      border-radius: 8px;
      box-shadow: 1px 1px 3px rgba(0,0,0,0.1);
      display: inline-block;
    }
    .question-box {
      text-align: center;
      margin: 2em 0;
    }
    .question-box button {
      font-size: 1em;
      padding: 0.8em 1.4em;
      margin: 0.5em;
      border: none;
      border-radius: 6px;
      background-color: #3faef7;
      color: white;
      cursor: pointer;
    }
    .question-box button:hover {
      background-color: #2c93d1;
    }
    #start-again {
      background-color: #5d5d5d;
    }
    .tree {
      display: flex;
      flex-direction: column;
      align-items: stretch;
      gap: 2em;
    }
  </style>
</head>
<body>

  <h1>üå≥ Level 0 Affordances Test ‚Äì v4</h1>
  <div class="timer">‚è±Ô∏è Time: <span id="timer">0.00s</span></div>

  <div class="tree" id="tree-container">
    <!-- Stakeholder branches will go here -->
  </div>

  <div class="question-box" id="question-box">
    <div id="question-text">Loading...</div>
    <button id="option-a">Option A</button>
    <button id="option-b">Option B</button><br/>
    <button id="start-again">üîÅ Start Again</button>
  </div>

<script>
const stakeholders = [
  {
    name: "Founders",
    emoji: "üå±",
    affordances: [
      "Platform custodianship",
      "Roadmap control",
      "Protocol definition authority"
    ]
  },
  {
    name: "Core Developers",
    emoji: "üåø",
    affordances: [
      "Build MVP backend",
      "Build MVP frontend",
      "Leaderboard",
      "Claims",
      "Explorer",
      "Wallet flow",
      "Publish Protocol Schema Draft"
    ]
  },
  {
    name: "Marketing & Operations",
    emoji: "üì£",
    affordances: [
      "Website publishing",
      "Whitepaper comms",
      "Community touchpoints (Telegram, CMC)"
    ]
  },
  {
    name: "Players",
    emoji: "üïπÔ∏è",
    affordances: [
      "Enter main game",
      "Receive scores",
      "Claim mock rewards",
      "Appear in explorer"
    ]
  },
  {
    name: "3rd-Party GQT Creators",
    emoji: "üéÆ",
    affordances: [
      "Protocol documentation available; cannot publish GQTs but can design around the config"
    ]
  },
  {
    name: "Reward Pool Organisers",
    emoji: "üéÅ",
    affordances: [
      "Create CGTs and fund prize pools",
      "Record leaderboard snapshots to blockchain"
    ]
  },
  {
    name: "Stakers",
    emoji: "üí∞",
    affordances: [
      "Stake tokens in staking pool",
      "Earn share of premium game fees"
    ]
  },
  {
    name: "Ecosystem Builders",
    emoji: "üèóÔ∏è",
    affordances: [
      "Create guides and tools for CGT users",
      "Propose improvements to GQT standards"
    ]
  },
  {
    name: "CGT Service Providers",
    emoji: "üõ†Ô∏è",
    affordances: [
      "Offer moderation, hosting or audits",
      "List services in CGT Service Directory"
    ]
  },
  {
    name: "DAO / Sub-DAOs",
    emoji: "üèõÔ∏è",
    affordances: [
      "Log readiness signals for DAO ladder",
      "Track stakeholder activity readiness"
    ]
  }
];

let currentStakeholderIndex = 0;
let currentAffordanceIndex = 0;
let timer = 0;
let interval;

const timerEl = document.getElementById("timer");
const questionBox = document.getElementById("question-box");
const treeContainer = document.getElementById("tree-container");
const questionText = document.getElementById("question-text");
const optionA = document.getElementById("option-a");
const optionB = document.getElementById("option-b");
const startAgain = document.getElementById("start-again");

function startTimer() {
  timer = 0;
  interval = setInterval(() => {
    timer += 0.1;
    timerEl.textContent = timer.toFixed(2) + "s";
  }, 100);
}

function stopTimer() {
  clearInterval(interval);
}

function shuffle(array) {
  return array.sort(() => Math.random() - 0.5);
}

function createStakeholderBlock(stakeholder, alignRight = false) {
  const block = document.createElement("div");
  block.className = "stakeholder " + (alignRight ? "right" : "left");
  block.id = `stakeholder-${stakeholder.name}`;
  block.innerHTML = `<h2>${stakeholder.emoji} <strong>${stakeholder.name}</strong></h2>`;
  treeContainer.appendChild(block);
  return block;
}

function loadNextQuestion() {
  const stakeholder = stakeholders[currentStakeholderIndex];
  if (!stakeholder) {
    questionText.textContent = "‚úÖ All done!";
    stopTimer();
    optionA.style.display = optionB.style.display = "none";
    return;
  }

  if (currentAffordanceIndex === 0) {
    createStakeholderBlock(stakeholder, currentStakeholderIndex % 2 === 1);
  }

  const affordance = stakeholder.affordances[currentAffordanceIndex];
  const questionNumber = currentAffordanceIndex + 1;
  questionText.textContent = `What is Level 0 affordance (${questionNumber}) of ${stakeholder.name}?`;

  const distractors = stakeholders
    .filter((s, i) => i !== currentStakeholderIndex)
    .flatMap(s => s.affordances);
  const wrong = distractors[Math.floor(Math.random() * distractors.length)];
  const options = shuffle([affordance, wrong]);

  optionA.textContent = options[0];
  optionB.textContent = options[1];

  const handleAnswer = (chosen) => {
    if (chosen === affordance) {
      const block = document.getElementById(`stakeholder-${stakeholder.name}`);
      const leaf = document.createElement("div");
      leaf.className = "leaf";
      leaf.textContent = `(${questionNumber}) ${affordance}`;
      block.appendChild(leaf);
      currentAffordanceIndex++;

      if (currentAffordanceIndex >= stakeholder.affordances.length) {
        currentStakeholderIndex++;
        currentAffordanceIndex = 0;
      }
      setTimeout(loadNextQuestion, 500);
    } else {
      questionText.textContent = "‚ùå Try again...";
    }
  };

  optionA.onclick = () => handleAnswer(options[0]);
  optionB.onclick = () => handleAnswer(options[1]);
}

startAgain.onclick = () => {
  location.reload();
};

window.onload = () => {
  startTimer();
  loadNextQuestion();
};
</script>
</body>
</html>
